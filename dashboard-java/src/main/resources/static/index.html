<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VarMiner · Product Backlog</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span class="brand-icon">◈</span>
                <span class="brand-text">VarMiner</span>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">▣</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="capture">
                    <span class="nav-icon">⊕</span>
                    <span>Capture requirement</span>
                </a>
                <a href="#" class="nav-item" data-view="backlog">
                    <span class="nav-icon">≡</span>
                    <span>Product backlog</span>
                </a>
                <a href="#" class="nav-item nav-item-q1" data-view="q1" title="Q1 2026 requirements">
                    <span class="nav-icon">Q1</span>
                    <span>2026</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <span class="footer-label">Requirements</span>
                <span class="footer-meta">CSV-backed</span>
            </div>
        </aside>
        <main class="main">
            <header class="main-header">
                <h1 class="page-title" data-title>Dashboard</h1>
                <p class="page-subtitle" data-subtitle>Overview and KPIs</p>
            </header>

            <!-- Dashboard: KPIs -->
            <section class="view" id="view-dashboard">
                <div class="upload-card">
                    <h3>Import CSV</h3>
                    <p>Upload a CSV with requirements in the same format (columns: ID, Category, Type, Requirement, Description, Status, Priority, etc.). It will replace current data.</p>
                    <div class="upload-zone" id="upload-zone">
                        <input type="file" id="csv-file" accept=".csv" />
                        <label for="csv-file">Choose CSV file</label> or drag and drop
                    </div>
                    <div id="upload-message" class="message hidden"></div>
                </div>
                <div class="kpi-grid" id="kpi-grid">
                    <div class="kpi-card kpi-total kpi-clickable" data-status="" title="Click to view all tasks">
                        <span class="kpi-value" id="kpi-total">—</span>
                        <span class="kpi-label">Total requirements</span>
                    </div>
                    <div class="kpi-card kpi-clickable" data-status="Not started" title="Click to view tasks">
                        <span class="kpi-value" id="kpi-not-started">—</span>
                        <span class="kpi-label">Not started</span>
                    </div>
                    <div class="kpi-card kpi-clickable" data-status="In DEV" title="Click to view tasks">
                        <span class="kpi-value" id="kpi-in-dev">—</span>
                        <span class="kpi-label">In DEV</span>
                    </div>
                    <div class="kpi-card kpi-clickable" data-status="In UAT" title="Click to view tasks">
                        <span class="kpi-value" id="kpi-in-uat">—</span>
                        <span class="kpi-label">In UAT</span>
                    </div>
                    <div class="kpi-card kpi-clickable" data-status="Dev completed" title="Click to view tasks">
                        <span class="kpi-value" id="kpi-dev-completed">—</span>
                        <span class="kpi-label">Dev completed</span>
                    </div>
                    <div class="kpi-card kpi-clickable" data-status="Closed" title="Click to view tasks">
                        <span class="kpi-value" id="kpi-closed">—</span>
                        <span class="kpi-label">Closed</span>
                    </div>
                </div>
                <div class="charts-row">
                    <div class="chart-card">
                        <h3>By status</h3>
                        <div class="chart-container">
                            <canvas id="chart-status"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>By priority</h3>
                        <div class="chart-container">
                            <canvas id="chart-priority"></canvas>
                        </div>
                    </div>
                </div>
                <div class="charts-row">
                    <div class="chart-card">
                        <h3>Clear requirement</h3>
                        <div class="chart-container">
                            <canvas id="chart-clear"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Release schedule</h3>
                        <div class="chart-container">
                            <canvas id="chart-release"></canvas>
                        </div>
                    </div>
                </div>
                <div class="dashboard-extra">
                    <p class="hint">Click any KPI or chart segment to view filtered requirements in the backlog. Use <strong>Capture requirement</strong> to add new items; use <strong>Product backlog</strong> to view and filter the full list.</p>
                </div>
            </section>

            <!-- Capture requirement -->
            <section class="view hidden" id="view-capture">
                <div class="card form-card">
                    <h2 class="card-title">New requirement</h2>
                    <form id="form-capture" class="form-capture">
                        <div class="form-row">
                            <label>Requirement <span class="req">*</span></label>
                            <input type="text" name="requirement" placeholder="One-sentence description of what will be delivered" required>
                        </div>
                        <div class="form-row">
                            <label>Description</label>
                            <textarea name="description" rows="3" placeholder="Context and scope"></textarea>
                        </div>
                        <div class="form-row">
                            <label>Acceptance criteria</label>
                            <textarea name="acceptanceCriteria" rows="2" placeholder="• Criterion 1&#10;• Criterion 2"></textarea>
                        </div>
                        <div class="form-grid">
                            <div class="form-row">
                                <label>Category</label>
                                <input type="text" name="category" value="VarMiner" placeholder="VarMiner">
                            </div>
                            <div class="form-row">
                                <label>Type</label>
                                <select name="type">
                                    <option value="Report Requirements">Report Requirements</option>
                                    <option value="API">API</option>
                                    <option value="UI">UI</option>
                                    <option value="Other">Other</option>
                                    <option value="Adhoc">Adhoc</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Priority</label>
                                <select name="priority">
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Status</label>
                                <select name="status">
                                    <option value="Not started">Not started</option>
                                    <option value="In DEV">In DEV</option>
                                    <option value="In UAT">In UAT</option>
                                    <option value="Dev completed">Dev completed</option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Estimate</label>
                                <input type="text" name="estimate" placeholder="e.g. 8">
                            </div>
                            <div class="form-row">
                                <label>Stack rank</label>
                                <input type="text" name="stackRank" placeholder="1">
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-row">
                                <label>Requestee dept</label>
                                <input type="text" name="requesteeDept" placeholder="e.g. CRT">
                            </div>
                            <div class="form-row">
                                <label>Requested by</label>
                                <input type="text" name="requestedBy" placeholder="Team or name">
                            </div>
                            <div class="form-row">
                                <label>Assignee</label>
                                <input type="text" name="assignee" placeholder="Name">
                            </div>
                            <div class="form-row">
                                <label>Release</label>
                                <input type="text" name="release" placeholder="e.g. Q3-2025">
                            </div>
                            <div class="form-row">
                                <label>Start sprint</label>
                                <input type="text" name="startSprint" placeholder="e.g. July H2">
                            </div>
                            <div class="form-row">
                                <label>Target sprint</label>
                                <input type="text" name="targetSprint" placeholder="e.g. Aug H2">
                            </div>
                        </div>
                        <div class="form-row">
                            <label>Clear requirement?</label>
                            <select name="clear">
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>Dependency (IDs)</label>
                            <input type="text" name="dependency" placeholder="e.g. VR-001, VR-002 or —">
                        </div>
                        <div class="form-row">
                            <label>Comments</label>
                            <textarea name="comments" rows="2" placeholder="Optional notes"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Save requirement</button>
                            <button type="reset" class="btn btn-secondary">Reset</button>
                        </div>
                    </form>
                </div>
                <div id="capture-message" class="message hidden"></div>
            </section>

            <!-- Product backlog -->
            <section class="view hidden" id="view-backlog">
                <div class="toolbar">
                    <div class="filters">
                        <label>Status</label>
                        <select id="filter-status">
                            <option value="">All</option>
                            <option value="Not started">Not started</option>
                            <option value="In DEV">In DEV</option>
                            <option value="In UAT">In UAT</option>
                            <option value="Dev completed">Dev completed</option>
                            <option value="Closed">Closed</option>
                        </select>
                        <label>Type</label>
                        <select id="filter-type">
                            <option value="">All</option>
                            <option value="Report Requirements">Report Requirements</option>
                            <option value="API">API</option>
                            <option value="UI">UI</option>
                            <option value="Other">Other</option>
                            <option value="Adhoc">Adhoc</option>
                        </select>
                        <label>Priority</label>
                        <select id="filter-priority">
                            <option value="">All</option>
                            <option value="Critical">Critical</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                        <label>Clear req.</label>
                        <select id="filter-clear">
                            <option value="">All</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                        </select>
                        <label>Release</label>
                        <select id="filter-release">
                            <option value="">All</option>
                        </select>
                    </div>
                </div>
                <div class="card table-card">
                    <div class="table-wrap">
                        <table class="backlog-table" id="backlog-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Requirement</th>
                                    <th>Type</th>
                                    <th>Priority</th>
                                    <th>Status</th>
                                    <th>Estimate</th>
                                    <th>Release</th>
                                    <th>Requested by</th>
                                </tr>
                            </thead>
                            <tbody id="backlog-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Q1 2026 Backlog (requirements with Release containing Q1) -->
            <section class="view hidden" id="view-q1">
                <p class="hint q1-hint">Requirements scheduled for <strong>Q1 2026</strong> (Release contains &ldquo;Q1&rdquo;). Click a row to edit or delete.</p>
                <div class="card table-card">
                    <div class="table-wrap">
                        <table class="backlog-table" id="q1-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Requirement</th>
                                    <th>Type</th>
                                    <th>Priority</th>
                                    <th>Status</th>
                                    <th>Estimate</th>
                                    <th>Release</th>
                                    <th>Requested by</th>
                                </tr>
                            </thead>
                            <tbody id="q1-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Shared detail panel (used by Product backlog and Q1 Backlog) -->
            <div class="detail-panel hidden" id="detail-panel">
                    <div class="detail-header">
                        <h3 id="detail-title">Edit requirement</h3>
                        <button type="button" class="btn-close" id="detail-close" aria-label="Close">×</button>
                    </div>
                    <form id="form-detail" class="form-capture form-detail">
                        <input type="hidden" name="id" id="detail-id" />
                        <div class="form-row">
                            <label>Requirement <span class="req">*</span></label>
                            <input type="text" name="requirement" required>
                        </div>
                        <div class="form-row">
                            <label>Description</label>
                            <textarea name="description" rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <label>Acceptance criteria</label>
                            <textarea name="acceptanceCriteria" rows="2"></textarea>
                        </div>
                        <div class="form-grid">
                            <div class="form-row">
                                <label>Category</label>
                                <input type="text" name="category" placeholder="VarMiner">
                            </div>
                            <div class="form-row">
                                <label>Type</label>
                                <select name="type">
                                    <option value="Report Requirements">Report Requirements</option>
                                    <option value="API">API</option>
                                    <option value="UI">UI</option>
                                    <option value="Other">Other</option>
                                    <option value="Adhoc">Adhoc</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Priority</label>
                                <select name="priority">
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Status</label>
                                <select name="status">
                                    <option value="Not started">Not started</option>
                                    <option value="In DEV">In DEV</option>
                                    <option value="In UAT">In UAT</option>
                                    <option value="Dev completed">Dev completed</option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Estimate</label>
                                <input type="text" name="estimate" placeholder="e.g. 8">
                            </div>
                            <div class="form-row">
                                <label>Stack rank</label>
                                <input type="text" name="stackRank" placeholder="1">
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-row">
                                <label>Requestee dept</label>
                                <input type="text" name="requesteeDept" placeholder="e.g. CRT">
                            </div>
                            <div class="form-row">
                                <label>Requested by</label>
                                <input type="text" name="requestedBy" placeholder="Team or name">
                            </div>
                            <div class="form-row">
                                <label>Assignee</label>
                                <input type="text" name="assignee" placeholder="Name">
                            </div>
                            <div class="form-row">
                                <label>Release</label>
                                <input type="text" name="release" placeholder="e.g. Q3-2025">
                            </div>
                            <div class="form-row">
                                <label>Start sprint</label>
                                <input type="text" name="startSprint" placeholder="e.g. July H2">
                            </div>
                            <div class="form-row">
                                <label>Target sprint</label>
                                <input type="text" name="targetSprint" placeholder="e.g. Aug H2">
                            </div>
                        </div>
                        <div class="form-row">
                            <label>Clear requirement?</label>
                            <select name="clear">
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label>Dependency (IDs)</label>
                            <input type="text" name="dependency" placeholder="e.g. VR-001, VR-002 or —">
                        </div>
                        <div class="form-row">
                            <label>Comments</label>
                            <textarea name="comments" rows="2" placeholder="Optional notes"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Save changes</button>
                            <button type="button" class="btn btn-secondary" id="detail-cancel">Cancel</button>
                            <button type="button" class="btn btn-danger" id="detail-delete">Delete requirement</button>
                        </div>
                    </form>
                    <div id="detail-message" class="message hidden"></div>
                </div>
        </main>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/js/app.js?v=2"></script>
</body>
</html>
